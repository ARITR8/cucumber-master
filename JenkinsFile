stage 'Init'



node ('xx-node') {
                    
                

stage ('Checkout') {
          checkout scm
      }
      
      stage ('Maven Build') {
                        
                  //   echo $M2_HOME
					//	echo $PATH
                            
                         bat 'mvn test'
                     //   sh 'mvn test'
                            
                             }
                       
			
          stage('Cucumber Reports') {
        
		
			    cucumber buildStatus: 'UNSTABLE',
			    
			    fileIncludePattern: '**/cucumber.json',
			    jsonReportDirectory: 'target'
			

                              
        
			
                          }
                          
               stage('Html report') {
         
            publishHTML target: [
                reportName: 'Test',
                reportDir: 'target/cucumber',
                reportFiles: 'index.html', 
             
                keepAll: true,
                alwaysLinkToLastBuild: true,
                allowMissing: false
            ]               
              
                 }
                 
                 post {
    always {
      echo 'I will always execute this!'
      
      
      emailext body: "${currentBuild.currentResult}: Job ${env.JOB_NAME} build ${env.BUILD_NUMBER}\n More info at: ${env.BUILD_URL}",
                recipientProviders: [[$class: 'DevelopersRecipientProvider'], [$class: 'RequesterRecipientProvider']],
                subject: "Jenkins Build ${currentBuild.currentResult}: Job ${env.JOB_NAME}" 
    }
  } }       
                    
                
                    

